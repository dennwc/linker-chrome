<html>
<head>
    <link rel="import" href="/bower_components/polymer/polymer.html">
    <link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
    <link rel="import" href="/bower_components/paper-input/paper-input.html">
    <link rel="import" href="/bower_components/iron-icons/iron-icons.html">
    <link rel="import" href="/bower_components/paper-fab/paper-fab.html">
    <link rel="import" href="/elements/field.html">
    <link rel="import" href="/elements/signIn.html">
</head>
<body>
    <dom-module id="my-plugin">
        <template>
            <style>
                :host{
                    display: block;
                    width: 350px;
                }
                #btnAdd{
                    margin:auto;
                }
                .signIn{
                    background:rgba(0,0,0,0);
                    margin: auto;
                }
                #providers{
                    display: flex;
                    justify-content: center;
                }
            </style>
            <iron-ajax
                    id="getAjax"
                    auto
                    url={{fullUrl}}
                    handle-as="json"
                    on-response="handle"
                    on-error="_handleErrorResponse">
            </iron-ajax>
            <template is="dom-repeat" items="{{fields}}" index-as="index">
                <x-field key="{{item.key}}" value="{{item.val}}" on-delete="removeFields"></x-field>
            </template>
            <template is="dom-if" if="{{flag}}">
            <paper-fab id="btnAdd" mini icon="add" on-tap="addFields"></paper-fab>
            </template>
            <iron-ajax id="xhr"
                       method="POST"
                       body={{postFields}}
                       url={{fullUrl}}
                       handle-as="json"
                       content-type="application/json"
                       debounce-duration="1000">
            </iron-ajax>
            <iron-ajax
                    auto
                    url={{getUser}}
                    handle-as="json"
                    on-response="currentUser">
            </iron-ajax>
            <iron-ajax
                    id="getSignInUrl"
                    auto
                    url={{signInUrl}}
                    handle-as="json"
                    on-response="getProviders">
            </iron-ajax>
            <div id="providers">
            <template is="dom-if" if="{{!flag}}">
                <template is="dom-repeat" items="{{providers}}">
                    <sign-in prov-Id="{{item.id}}"
                             prov-Img="/img/login-{{item.id}}.png"
                             on-sign="signIn"></sign-in >
                </template>
            </template>
            </div>
        </template>
        <script src="plugin.html.0.js"></script>
    </dom-module>
</body>
</html>